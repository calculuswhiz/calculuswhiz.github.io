var w=Object.defineProperty;var M=(s,t,e)=>t in s?w(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var d=(s,t,e)=>(M(s,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();const g=6,p=5;function*y(s){const t=[...s].sort((e,r)=>r-e);for(let e=0;e<g;e++)for(let r=0;r<g;r++)e!==r&&(yield[t[e],t[r]])}class h{constructor(t,e,r){d(this,"children",new Array);d(this,"score");this.digits=t,this.currentMoves=e,this.value=r;const n=new Set;for(const i of e.split(";").slice(0,3).map(l=>l[0]))n.add(i);this.score=n.size**2*(e.length-1)}buildChildNodes(t){if(!(this.digits.size===1||t===0)){for(const[e,r]of y(this.digits)){const n=new Set(this.digits);if(n.delete(e),n.delete(r),e<=r){const u=new Set(n);if(u.add(e+r),this.children.push(new h(u,this.currentMoves+`+ ${e} ${r};`,e+r)),e*r!==1){const f=new Set(n);f.add(e*r),this.children.push(new h(f,this.currentMoves+`* ${e} ${r};`,e*r))}}const i=new Set(n);e-r>0&&(i.add(e-r),this.children.push(new h(i,this.currentMoves+`- ${e} ${r};`,e-r)));const l=new Set(n);Number.isInteger(e/r)&&r!==1&&(l.add(e/r),this.children.push(new h(l,this.currentMoves+`/ ${e} ${r};`,e/r)))}for(const e of this.children)e.buildChildNodes(t-1)}}}function S(s){s>p&&(s=p);const t=new Array;for(let c=1;c<=25;c++)t.splice((t.length+1)*Math.random(),0,c);const e=new Set(t.slice(0,g)),r=new h(e,"",void 0);r.buildChildNodes(3);const n=new Map;function i(c,a){(n.get(c)??0<a)&&n.set(c,a)}const l=[r];for(;l.length>0;){const c=l.shift();for(const a of(c==null?void 0:c.children)??[])i(a.value??0,a.score),l.push(a)}const u=[...n].sort((c,a)=>a[1]-c[1]),f=u.length*(1-(s-1+Math.random())/p)|0;return{digits:[...e].sort((c,a)=>c-a),winningValue:u[f][0],tree:r,scores:u}}const A={"+":(s,t)=>s+t,"-":(s,t)=>s-t,"*":(s,t)=>s*t,"/":(s,t)=>s/t};class m{constructor(){d(this,"operator",null);d(this,"a",null);d(this,"b",null)}getResult(){if(this.operator===null||this.a===null||this.b===null)throw Error("Invalid operation");return A[this.operator](this.a,this.b)}clear(){this.a=null,this.b=null,this.operator=null}}const o={puzzle:void 0,moves:new Array,currentMove:new m,unselectAll(){var s;for(const t of document.querySelectorAll(".selected"))t.setAttribute("class",((s=t.getAttribute("class"))==null?void 0:s.replace("selected",""))??"");this.currentMove=new m},evaluateMove(s){var t,e;if(this.currentMove.operator!==null&&this.currentMove.a!==null&&this.currentMove.b!==null){const r=this.currentMove.getResult();if(!Number.isInteger(r)||r<=0){this.unselectAll();return}s||this.moves.push(this.currentMove),(t=document.querySelector(`.digit-input[data-value='${this.currentMove.a}']`))==null||t.remove();const n=document.querySelector(`.digit-input[data-value='${this.currentMove.b}']`);n.textContent=r.toString(),n.dataset.value=n.textContent,this.unselectAll(),n.textContent===(((e=this.puzzle)==null?void 0:e.winningValue.toString())??"")&&alert("Puzzle cleared.")}},makeDigitButton(s){const t=document.createElement("div");return t.setAttribute("class","digit-input input-button"),t.textContent=s.toString(),t.dataset.value=s.toString(),t.addEventListener("click",e=>{const r=e.target,n=Number.parseInt(r.textContent??"0"),i=r.getAttribute("class");if((i==null?void 0:i.includes("selected"))??!1){r.setAttribute("class",(i==null?void 0:i.replace("selected",""))??""),this.currentMove.a===n?this.currentMove.a=null:this.currentMove.b===n&&(this.currentMove.b=null);return}this.currentMove.a===null?this.currentMove.a=n:this.currentMove.b=n,r.setAttribute("class",`${i} selected`),this.evaluateMove(!1)}),t},resetDigits(){const s=document.getElementById("usable-digits");if(s==null)throw Error("No place for digits");if(s.innerHTML="",this.puzzle==null)throw Error("No puzzle generated");for(const t of this.puzzle.digits)s.appendChild(this.makeDigitButton(t))},generateGame(s){this.puzzle=S(s),this.resetDigits(),console.log(this.puzzle.scores),console.log(`Puzzle target score: ${this.puzzle.scores.find(t=>{var e;return t[0]===((e=this.puzzle)==null?void 0:e.winningValue)})}`)}};let v;do v=parseInt(prompt(`Please input a difficulty (out of ${p})`,"1")??"1");while(Number.isNaN(v));o.generateGame(v);if(o.puzzle==null)throw Error("No puzzle generated.");document.getElementById("target-number").textContent=o.puzzle.winningValue.toString()??"";const E=["add-btn","sub-btn","mul-btn","div-btn"];for(const s of E)document.getElementById(s).addEventListener("click",t=>{var l;const e=t.target,r=e.dataset.opChar,n=e.getAttribute("class");if(o.currentMove.operator!==null){const u=document.querySelector(`div.selected[data-op-char='${o.currentMove.operator}']`);if(u.setAttribute("class",((l=u.getAttribute("class"))==null?void 0:l.replace("selected",""))??""),e===u){o.currentMove.operator=null;return}}e.setAttribute("class",`${n} selected`),o.currentMove.operator=r,o.evaluateMove(!1)});var b;(b=document.getElementById("undo-btn"))==null||b.addEventListener("click",s=>{if(o.unselectAll(),o.moves.length!==0){o.resetDigits(),o.moves.pop();for(const t of o.moves)o.currentMove=t,o.evaluateMove(!0);o.currentMove=new m}});var z;(z=document.getElementById("view-solution-btn"))==null||z.addEventListener("click",s=>{if(o.puzzle==null)throw Error("No puzzle generated.");if(confirm("View one possible shortest solution?")){const t=[o.puzzle.tree];for(;t.length>0;){const e=t.shift();for(const r of(e==null?void 0:e.children)??[]){if(r.value===o.puzzle.winningValue){alert(`One possible solution: ${r.currentMoves.replace(/;/g,`
`)}`);return}t.push(r)}}alert("Nothing found...?")}});document.body.style.display="";
